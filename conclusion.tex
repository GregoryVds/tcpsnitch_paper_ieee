\section{Discussion}\label{sec:conclusion}

We have proposed \tcpsnitchns, an application that intercepts network
system and library calls on the Linux and Android platforms to
collect more information about their usage, including the parameters
passed to those API calls. We collected more than 5~M API calls made by
more than 130 Linux and Android applications on 24~K sockets. The application
and the
collected dataset are publicly available\footnote{The entire dataset can be
explored via \url{https://tcpsnitch.org}. The \tcpsnitch source code is
available from \url{https://github.com/GregoryVds/tcpsnitch} and the web
interface can be retrieved from \url{https://github.com/GregoryVds/tcpsnitch_web}.
}.

Our analysis revealed several interesting patterns for the utilization
of the socket API on Android applications. First, in an IPv6 enabled
WiFi network, these applications prefer IPv6 over IPv4. Second, UDP sockets
are mainly used as a shortcut to retrieve information about the network
configuration: only 6\% of UDP sockets send or receive data on Android. Third, many
Android applications use the same pattern of system calls to establish and
terminate TCP connections. Fourth, Android applications use various socket
options, even some like \texttt{TCP\_INFO} that are not directly exposed by
the standard Java API. We revealed that \texttt{TCP\_INFO}, a non-standard
Linux TCP option, is the second most often used option with TCP sockets on
Android.

\tcpsnitch and its associated website provide an overview of how real
applications use the socket API. In summary, we observed that the socket API
usage in the wild differs greatly from textbook usage. Many Internet sockets
do not exchange data, many API calls are redundant and many calls use
tiny data buffers.
